@model IEnumerable<newBugTracker.Models.Project>
@using newBugTracker.Helpers;


<div class="main-heading">
    <div class="main-filter">
    </div>
</div>
<div class="panel-group" id="accordion-test-2">
    @foreach (var mod in Model)
    {
        <div class="container-fluid half-padding">
            <div class="template template__table_data">
                <div class="row">
                    <div class="col-md-12">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3 class="panel-title">
                                    <a data-toggle="collapse" data-target="#@mod.Name.Replace(" ", "")" class="collapsed">@mod.Name</a>
                                </h3>
                            </div>
                            <div class="panel-body">
                                <div class="container-fluid half-padding">
                                    <div id="buttons"></div>
                                    <div class="collapse" id="@mod.Name.Replace(" ", "")">
                                        <div class="panel-body">
                                            <table id="datatable-responsive" class="table table-striped table-bordered dt-responsive nowrap dataTable " cellspacing="0" width="100%">
                                                <thead>
                                                    <tr>
                                                        <th>@Html.DisplayName("Title")</th>
                                                        <th>@Html.DisplayName("Description")</th>
                                                        <th>@Html.DisplayName("Assigned To")</th>
                                                        <th>@Html.DisplayName("Created By")</th>
                                                        <th>@Html.DisplayName("Priority")</th>
                                                        <th>@Html.DisplayName("Status")</th>
                                                        <th>@Html.DisplayName("Type")</th>
                                                        <th>@Html.DisplayName("Created")</th>
                                                        <th>@Html.DisplayName("Updated")</th>
                                                        <th></th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    @foreach (var ticket in mod.Tickets)
                                                    {
                                                        <tr>
                                                            <td>@ticket.Title</td>
                                                            <td>@ticket.Description</td>
                                                            @if (ticket.AssignedToUser == null)
                                                            {
                                                                <td></td>}
                                                            else
                                                            {
                                                                <td>@ticket.AssignedToUser.FirstName</td>
                                                            }
                                                            <td>@ticket.OwnerUser.FirstName</td>
                                                            <td>
                                                                @if (ticket.TicketPriorityId == 1)
                                                                {
                                                                    <span class="label label-warning">
                                                                        @Html.DisplayFor(modelItem => ticket.TicketPriority.Name)
                                                                    </span>
                                                                }
                                                                @if (ticket.TicketPriorityId == 2)
                                                                {
                                                                    <span class="label label-success">
                                                                        @Html.DisplayFor(modelItem => ticket.TicketPriority.Name)
                                                                    </span>
                                                                }
                                                                @if (ticket.TicketPriorityId == 3)
                                                                {
                                                                    <span class="label label-primary">
                                                                        @Html.DisplayFor(modelItem => ticket.TicketPriority.Name)
                                                                    </span>
                                                                }
                                                                @if (ticket.TicketPriorityId == 4)
                                                                {
                                                                    <span class="label label-danger">
                                                                        @Html.DisplayFor(modelItem => ticket.TicketPriority.Name)
                                                                    </span>
                                                                }
                                                            </td>
                                                            <td>
                                                                @if (item.TicketStatusId == 1)
                                                                {
                                                                    <span class="label" style="background-color: slategray">
                                                                        @Html.DisplayFor(modelItem => item.TicketStatus.Name)
                                                                    </span>
                                                                }
                                                                @if (item.TicketStatusId == 2)
                                                                {
                                                                    <span class="label label-info">
                                                                        @Html.DisplayFor(modelItem => item.TicketStatus.Name)
                                                                    </span>
                                                                }
                                                                @if (item.TicketStatusId == 3)
                                                                {
                                                                    <span class="label label-success">
                                                                        @Html.DisplayFor(modelItem => item.TicketStatus.Name)
                                                                    </span>
                                                                }
                                                            </td>
                                                            <td>@ticket.TicketType.Name</td>
                                                            <td>@ticket.Created</td>
                                                            <td>@ticket.Updated</td>
                                                            <td>
                                                                @Html.ActionLink("Edit", "Edit", "Tickets", new { id = ticket.Id }, new { @class = "btn btn-inverse btn-xs m-b-5" })
                                                                @Html.ActionLink("Details", "Details", "Tickets", new { id = ticket.Id }, new { @class = "btn btn-inverse btn-xs m-b-5" })
                                                                @Html.ActionLink("Delete", "Delete", "Ticket", new { id = ticket.Id }, new { @class = "btn btn-inverse btn-xs m-b-5" })
                                                            </td>
                                                        </tr>
                                                    }
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }
</div>

<p>
    <input action="action" onclick="window.history.go(-1); return false;" type="button" value="Back" class="btn btn-inverse btn-xs m-b-5" />
</p>
